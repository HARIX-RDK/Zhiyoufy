"use strict";(self.webpackChunkzhiyoufy_docs=self.webpackChunkzhiyoufy_docs||[]).push([[877],{9758:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>a,frontMatter:()=>t,metadata:()=>d,toc:()=>s});var r=o(4848),i=o(8453);const t={},c=void 0,d={id:"developer-guide/framework_usage/zhiyoufy-auto-test/support_new_grpc_client",title:"support_new_grpc_client",description:"\u76ee\u5f55\u7ec4\u7ec7\u8bf4\u660e",source:"@site/docs/0300-developer-guide/0200-framework_usage/zhiyoufy-auto-test/00400-support_new_grpc_client.md",sourceDirName:"0300-developer-guide/0200-framework_usage/zhiyoufy-auto-test",slug:"/developer-guide/framework_usage/zhiyoufy-auto-test/support_new_grpc_client",permalink:"/Zhiyoufy/developer-guide/framework_usage/zhiyoufy-auto-test/support_new_grpc_client",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:400,frontMatter:{},sidebar:"docSidebar",previous:{title:"\u8c03\u8bd5case",permalink:"/Zhiyoufy/developer-guide/framework_usage/zhiyoufy-auto-test/debug_case"},next:{title:"support-run-case-from-portal",permalink:"/Zhiyoufy/developer-guide/framework_usage/zhiyoufy-auto-test/support-run-case-from-portal"}},l={},s=[{value:"\u76ee\u5f55\u7ec4\u7ec7\u8bf4\u660e",id:"\u76ee\u5f55\u7ec4\u7ec7\u8bf4\u660e",level:2},{value:"add proto file",id:"add-proto-file",level:2},{value:"modify proto file",id:"modify-proto-file",level:2},{value:"generate grpc code",id:"generate-grpc-code",level:2},{value:"\u6dfb\u52a0client",id:"\u6dfb\u52a0client",level:2},{value:"\u53c2\u7167\u670d\u52a1\u63d0\u4f9b\u65b9\u793a\u4f8b",id:"\u53c2\u7167\u670d\u52a1\u63d0\u4f9b\u65b9\u793a\u4f8b",level:3},{value:"\u521b\u5efapython\u4fa7client",id:"\u521b\u5efapython\u4fa7client",level:3},{value:"\u521b\u5efaDynamicFlowClient",id:"\u521b\u5efadynamicflowclient",level:2},{value:"\u521b\u5efaj2\u811a\u672c\u9a8c\u8bc1\u57fa\u672c\u529f\u80fd",id:"\u521b\u5efaj2\u811a\u672c\u9a8c\u8bc1\u57fa\u672c\u529f\u80fd",level:2}];function p(e){const n={code:"code",h2:"h2",h3:"h3",p:"p",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u76ee\u5f55\u7ec4\u7ec7\u8bf4\u660e",children:"\u76ee\u5f55\u7ec4\u7ec7\u8bf4\u660e"}),"\n",(0,r.jsxs)(n.p,{children:["\u6240\u6709proto\u6587\u4ef6\u4f1a\u653e\u5728",(0,r.jsx)(n.code,{children:"protos"}),"\u76ee\u5f55\uff0c\u7136\u540e\u4e0b\u4e00\u7ea7\u76ee\u5f55\u7528\u6765\u533a\u5206\n\u5927\u7684\u8f6f\u4ef6\uff0c\u518d\u4e0b\u4e00\u7ea7\u76ee\u5f55\u56fa\u5b9a\u4e3a",(0,r.jsx)(n.code,{children:"grpc"}),"\uff0c\u8fd9\u4e2a\u662f\u4e3a\u4e86\u628agrpc\u81ea\u52a8\n\u751f\u6210\u7684\u4ee3\u7801\u653e\u5230\u4e00\u8d77\u548c\u624b\u5199\u7684\u4ee3\u7801\u533a\u5206\u5f00"]}),"\n",(0,r.jsx)(n.h2,{id:"add-proto-file",children:"add proto file"}),"\n",(0,r.jsx)(n.p,{children:"\u5728protos\u76ee\u5f55\u4e0b\u6dfb\u52a0proto\u6587\u4ef6\uff0c\u6bd4\u5982"}),"\n",(0,r.jsxs)(n.p,{children:["\u56e0\u4e3a",(0,r.jsx)(n.code,{children:"routing.proto"}),"\u6587\u4ef6\u91cc\u7684java_package\u8def\u5f84\u662f\n",(0,r.jsx)(n.code,{children:"com.cloudminds.harix.routing"}),"\uff0c\u6240\u4ee5\u6211\u4eec\u53c2\u8003\u5b83\u521b\u5efa\n",(0,r.jsx)(n.code,{children:"protos/harix/grpc/routing"}),"\u76ee\u5f55\uff0c\u7136\u540e\u628a",(0,r.jsx)(n.code,{children:"routing.proto"}),"\n\u653e\u5230\u4e0b\u9762"]}),"\n",(0,r.jsx)(n.h2,{id:"modify-proto-file",children:"modify proto file"}),"\n",(0,r.jsx)(n.p,{children:"\u56e0\u4e3a\u6211\u4eec\u7684\u76ee\u5f55\u7ec4\u7ec7\u7ed3\u6784\u548cproto\u91cc\u5199\u7684\u4e0d\u4e00\u81f4\uff0c\u4e3b\u8981\u662fbase\u8def\u5f84\u4e0d\u4e00\u81f4\uff0c\n\u6240\u4ee5\u9700\u8981\u4fee\u6539proto\u6587\u4ef6\u9002\u5e94\uff0c\u6bd4\u5982\u4fee\u6539"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:'import "common/common.proto";'})," \u5230 ",(0,r.jsx)(n.code,{children:'import "harix/grpc/common/common.proto";'})]}),"\n",(0,r.jsx)(n.h2,{id:"generate-grpc-code",children:"generate grpc code"}),"\n",(0,r.jsxs)(n.p,{children:["\u4fee\u6539",(0,r.jsx)(n.code,{children:"generate_pb.py"}),"\u6dfb\u52a0proto\u6587\u4ef6\u8def\u5f84\u5230\u5bf9\u5e94\u5217\u8868\uff0c\u6bd4\u5982\u6dfb\u52a0\n",(0,r.jsx)(n.code,{children:"./protos/harix/grpc/routing/routing.proto"}),"\u5230",(0,r.jsx)(n.code,{children:"generate_for_harix"}),"\n\u4e2d\u7684\u5217\u8868 ",(0,r.jsx)(n.strong,{children:"\u8bf7\u6309\u7167\u5b57\u6bcd\u987a\u5e8f\u6dfb\u52a0\uff0c\u8fd9\u6837\u53ef\u4ee5\u65b9\u4fbf\u548c\u6587\u4ef6\u7cfb\u7edf\u5bf9\u6bd4\u54ea\u4e2a\u52a0\u4e86\u54ea\u4e2a\u6ca1\u52a0"})]}),"\n",(0,r.jsxs)(n.p,{children:["\u6267\u884c",(0,r.jsx)(n.code,{children:"generate_pb.py"}),"\u751f\u6210\u4ee3\u7801"]}),"\n",(0,r.jsx)(n.h2,{id:"\u6dfb\u52a0client",children:"\u6dfb\u52a0client"}),"\n",(0,r.jsx)(n.h3,{id:"\u53c2\u7167\u670d\u52a1\u63d0\u4f9b\u65b9\u793a\u4f8b",children:"\u53c2\u7167\u670d\u52a1\u63d0\u4f9b\u65b9\u793a\u4f8b"}),"\n",(0,r.jsxs)(n.p,{children:["\u6bd4\u5982",(0,r.jsx)(n.code,{children:"routing.proto"}),"\u5bf9\u5e94\u670d\u52a1\u4e3a",(0,r.jsx)(n.code,{children:"harix-routing-service"}),"\uff0c\u4e0b\u8f7d\u4e0b\u6765\u540e\n\u9996\u5148\u5b89\u88c5\u4f9d\u8d56\u5305\uff0c\u8fd9\u6837\u5728IDE\u6bd4\u5982visual studio code\u4e2d\u53ef\u4ee5\u4ee3\u7801\u8df3\u8f6c\uff0c\u53c2\u7167\n\u9879\u76ee\u91cc\u7684",(0,r.jsx)(n.code,{children:"Dockerfile"}),"\u53ef\u4ee5\u77e5\u9053\u7528",(0,r.jsx)(n.code,{children:"go mod tidy"}),"\u5b89\u88c5\u4f9d\u8d56"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u5177\u4f53go\u73af\u5883\u5b89\u88c5\u53c2\u8003go\u5b98\u65b9\u6587\u6863"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5b66\u4e60\u7814\u7a76\u793a\u4f8b\u6bd4\u5982",(0,r.jsx)(n.code,{children:"test\\planning_test.go"})]}),"\n",(0,r.jsx)(n.h3,{id:"\u521b\u5efapython\u4fa7client",children:"\u521b\u5efapython\u4fa7client"}),"\n",(0,r.jsx)(n.p,{children:"\u65b0proto\u6587\u4ef6\u53ef\u80fd\u5c5e\u4e8e\u4e00\u4e2a\u65b0\u5e94\u7528\uff0c\u4e5f\u53ef\u80fd\u5c5e\u4e8e\u4e00\u4e2a\u5e94\u7528\u7684\u6a21\u5757"}),"\n",(0,r.jsxs)(n.p,{children:["\u4ee5",(0,r.jsx)(n.code,{children:"routing.proto"}),"\u4e3a\u4f8b\uff0c\u670d\u52a1\u63d0\u4f9b\u65b9\u53cd\u9988\u5b83\u662f\u4e00\u4e2a\u72ec\u7acb\u670d\u52a1\uff0c\u6240\u4ee5\u6211\u4eec\n\u5728",(0,r.jsx)(n.code,{children:"harix"}),"package\u4e0b\u521b\u5efa",(0,r.jsx)(n.code,{children:"routingclient"}),"package"]}),"\n",(0,r.jsx)(n.p,{children:"\u5177\u4f53client\u89c4\u5219\u53ef\u53c2\u8003framework_intro\u4e2d\u7684client\u6587\u6863"}),"\n",(0,r.jsx)(n.p,{children:"GrpcClient\u548c\u5176\u5b83Client\u7684\u533a\u522b\u53ea\u662f\u5b83\u4f1a\u901a\u8fc7grpc\u751f\u6210\u7684stub\u8c03\u7528grpc\u670d\u52a1\uff0c\u5176\u5b83\u65b9\u9762\n\u5e76\u6ca1\u6709\u533a\u522b"}),"\n",(0,r.jsx)(n.h2,{id:"\u521b\u5efadynamicflowclient",children:"\u521b\u5efaDynamicFlowClient"}),"\n",(0,r.jsxs)(n.p,{children:["\u6bd4\u5982\u9488\u5bf9",(0,r.jsx)(n.code,{children:"harix.routingclient"}),"\u521b\u5efa",(0,r.jsx)(n.code,{children:"harix.dynamicflow.DynamicFlowRoutingClient"}),"\uff0c\n\u5e76\u4e14\u5728",(0,r.jsx)(n.code,{children:"harix.app.TestDynamicFlow"}),"\u4e2d\u6ce8\u518c"]}),"\n",(0,r.jsx)(n.h2,{id:"\u521b\u5efaj2\u811a\u672c\u9a8c\u8bc1\u57fa\u672c\u529f\u80fd",children:"\u521b\u5efaj2\u811a\u672c\u9a8c\u8bc1\u57fa\u672c\u529f\u80fd"}),"\n",(0,r.jsxs)(n.p,{children:["\u6bd4\u5982\u521b\u5efa",(0,r.jsx)(n.code,{children:"data/templates/routing_test/simple_planning.json.j2"}),"\uff0c\u7136\u540e\u8c03\u8bd5\u9a8c\u8bc1"]})]})}function a(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>c,x:()=>d});var r=o(6540);const i={},t=r.createContext(i);function c(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);